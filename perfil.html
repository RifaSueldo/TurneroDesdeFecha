<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Subir Logo</title>
<style>
  body { font-family: Arial; display: flex; flex-direction: column; align-items: center; padding: 20px; }
  #preview { max-width: 200px; margin-bottom: 10px; }
  button { padding: 8px 16px; cursor: pointer; }
</style>
</head>
<body>

<h2>Subir Logo</h2>


<button id="uploadLogoBtn">Subir Logo</button>
<input type="file" id="logoFile" style="display:none" accept="image/*">
<img id="previewLogo" src="" alt="Logo" style="max-width:150px;margin-top:10px;">

<p id="status"></p>

<script>


const btn = document.getElementById("uploadLogoBtn");
const fileInput = document.getElementById("logoFile");
const preview = document.getElementById("previewLogo");

btn.addEventListener("click", () => fileInput.click());

fileInput.addEventListener("change", async () => {
  const file = fileInput.files[0];
  if (!file) return;

  // Mostrar preview
  preview.src = URL.createObjectURL(file);

  // Convertir a base64
  const reader = new FileReader();
  reader.readAsDataURL(file);
  reader.onload = async () => {
    let base64Data = reader.result.split(",")[1]; // quitar "data:image/png;base64,"
    
    const userId = "5fdc6c98-c92d-4e6a-a5d2-0f67736a796c"; // tomarlo de sesión o URL
    const fileName = file.name;

    // Llamada POST a Apps Script
    const res = await fetch("https://script.google.com/macros/s/AKfycbxKoJjty1C5xlTUZj3PnNVTubQdvpLVjyzWFj3YdCOEj8tLjNaJbG32wt_mOz8hFsNckw/exec", {
      method: "POST",
      body: new URLSearchParams({
        action: "uploadLogo",
        userId,
        file: base64Data,
        fileName
      })
    });
    const data = await res.json();

    if (data.status === "ok") {
      alert("Logo subido con éxito!");
      console.log("URL en Drive:", data.url);
    } else {
      alert("Error: " + data.msg);
    }
  };
});

</script>

</body>
</html>
